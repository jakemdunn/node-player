{"version":3,"sources":["library.js","player.js"],"names":["app","directive","$compile","$templateCache","LIBRARY_VIEW","restrict","scope","library","layout","templateUrl","link","element","filtered","selectedIndex","expandedIndex","expandAlbum","song","event","album","id","replace","$","target","parents","index","expanded","angular","forEach","indexOf","push","length","setTimeout","window","trigger","$watchGroup","current","html","get","contents","on","$albums","columns","Math","round","width","first","$apply","$on","off","constant","track","socket","player","params","console","log"],"mappings":"AAAAA,IAAAC,UAAA,WAAA,WAAA,iBAAA,eAAA,SAAAC,EAAAC,EAAAC,GAEA,OACAC,SAAA,IACAC,OACAC,QAAA,IACAC,OAAA,KAEAC,YAAA,8BACAC,KAAA,SAAAJ,EAAAK,GAEAL,EAAAM,YACAN,EAAAO,eAAA,EACAP,EAAAQ,eAAA,EAEAR,EAAAS,YAAA,SAAAC,EAAAC,GAEA,GAAAC,MACAC,EAAAH,EAAAG,GAAAC,QAAA,UAAA,IACAP,EAAAQ,EAAAJ,EAAAK,QAAAC,QAAA,UAAAC,OAGA,OAAAlB,GAAAO,gBAAAA,GACAP,EAAAO,eAAA,EACAP,EAAAQ,eAAA,OACAR,EAAAmB,UAAA,KAGAnB,EAAAO,cAAAA,EAEAa,QAAAC,QAAArB,EAAAC,QAAA,SAAAS,GACA,GAAA,KAAAA,EAAAG,GAAAS,QAAAT,GACAD,EAAAW,KAAAb,OACA,IAAAE,EAAAY,OAAA,EACA,OAAA,IAIAxB,EAAAmB,SAAAP,MAEAa,YAAA,WACAV,EAAAW,QAAAC,QAAA,mBACA,KAGA3B,EAAA4B,aAAA,UAAA,UAAA,WAGA,GAAA5B,EAAAE,QAAAJ,EAAAc,MAAA,CAEAZ,EAAAM,WAEA,IAAAuB,GAAA,EACAT,SAAAC,QAAArB,EAAAC,QAAA,SAAAS,GACA,GAAAG,GAAAH,EAAAG,GAAAC,QAAA,UAAA,GACAe,KAAAhB,IACAgB,EAAAhB,EACAb,EAAAM,SAAAiB,KAAAb,UAIAV,GAAAM,SAAAN,EAAAC,OAIAI,GAAAyB,KAAAjC,EAAAkC,IAAA/B,EAAAE,SACAN,EAAAS,EAAA2B,YAAAhC,KAIAe,EAAAW,QAAAO,GAAA,iBAAA,WACA,GAAAjC,EAAAO,iBAAA,EAAA,CAGA,GAAA2B,GAAAnB,EAAA,kBACAoB,EAAAC,KAAAC,MAAAtB,EAAAW,QAAAY,QAAAJ,EAAAK,QAAAD,SACA9B,EAAA,CAEAA,GAAAR,EAAAO,eAAA4B,EAAAnC,EAAAO,cAAA4B,GAAA,EACA3B,GAAA0B,EAAAV,SAAAhB,EAAA0B,EAAAV,OAAA,GAEAxB,EAAAwC,OAAA,WACAxC,EAAAQ,cAAAA,OAIAR,EAAAyC,IAAA,WAAA,WACA1B,EAAAW,QAAAgB,IAAA,yBAMAhD,IAAAiD,SAAA,gBACA/B,MAAA,aACAgC,MAAA,eC/FAlD,IAAAC,UAAA,UAAA,WAAA,iBAAA,SAAA,SAAAC,EAAAC,EAAAgD,GAEA,OACA9C,SAAA,IACAC,OACA8C,OAAA,KAEA3C,YAAA,6BACAC,KAAA,WACAyC,EAAAZ,GAAA,eAAA,SAAAc,GACAC,QAAAC,IAAAF","file":"directives.js","sourcesContent":["app.directive('library',['$compile','$templateCache','LIBRARY_VIEW',function($compile,$templateCache,LIBRARY_VIEW){\n\n\treturn {\n\t\trestrict: 'A',\n\t\tscope:{\n\t\t\tlibrary:'=',\n\t\t\tlayout:'='\n\t\t},\n\t\ttemplateUrl:'views/partials/library.html',\n\t\tlink:function(scope,element,attributes){\n\n\t\t\tscope.filtered = [];\n\t\t\tscope.selectedIndex = false;\n\t\t\tscope.expandedIndex = false;\n\n\t\t\tscope.expandAlbum = function(song,event)\n\t\t\t{\n\t\t\t\tvar album = [],\n\t\t\t\t\tid = song.id.replace(/[^\\/]*$/,''),\n\t\t\t\t\tselectedIndex = $(event.target).parents('.album').index();\n\n\t\t\t\t// Collapse if open\n\t\t\t\tif(scope.selectedIndex === selectedIndex){\n\t\t\t\t\tscope.selectedIndex = false;\n\t\t\t\t\tscope.expandedIndex = false;\n\t\t\t\t\tscope.expanded = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tscope.selectedIndex = selectedIndex;\n\n\t\t\t\tangular.forEach(scope.library, function(song, key) {\n\t\t\t\t\tif(song.id.indexOf(id) !== -1){\n\t\t\t\t\t\talbum.push(song);\n\t\t\t\t\t}else if(album.length > 0){ // We've found all our album items\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tscope.expanded = album;\n\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$(window).trigger('resize.library');\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t\tscope.$watchGroup(['library','layout'],function(){\n\n\t\t\t\t// Filter our library\n\t\t\t\tif(scope.layout == LIBRARY_VIEW.album){\n\t\t\t\t\t// Only show the first song per album\n\t\t\t\t\tscope.filtered = [];\n\n\t\t\t\t\tvar current = '';\n\t\t\t\t\tangular.forEach(scope.library, function(song, key) {\n\t\t\t\t\t\tvar id = song.id.replace(/[^\\/]*$/,'');\n\t\t\t\t\t\tif(current !== id){\n\t\t\t\t\t\t\tcurrent = id;\n\t\t\t\t\t\t\tscope.filtered.push(song);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else{ // No filtering, just show them all\n\t\t\t\t\tscope.filtered = scope.library;\n\t\t\t\t}\n\n\t\t\t\t// Set the template\n\t\t\t\telement.html($templateCache.get(scope.layout));\n            \t$compile(element.contents())(scope);\n\t\t\t});\n\n\t\t\t// Expanded should be placed on the first newline after the clicked album\n\t\t\t$(window).on('resize.library',function(){\n\t\t\t\tif(scope.selectedIndex === false) return;\n\n\t\t\t\t// Figure out how many columns we currently have\n\t\t\t\tvar $albums = $('.album-content'),\n\t\t\t\t\tcolumns = Math.round($(window).width() / $albums.first().width()),\n\t\t\t\t\texpandedIndex = 0;\n\n\t\t\t\texpandedIndex = scope.selectedIndex + (columns - (scope.selectedIndex % columns)) - 1;\n\t\t\t\tif(expandedIndex >= $albums.length) expandedIndex = $albums.length - 1;\n\n\t\t\t\tscope.$apply(function () {\n\t\t\t\t\tscope.expandedIndex = expandedIndex;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tscope.$on('$destroy', function(){\n\t\t\t\t$(window).off('resize.library');\n\t\t\t});\n\t\t}\n\t}\n}]);\n\napp.constant('LIBRARY_VIEW', {\n\talbum: 'album-view',\n\ttrack: 'track-view'\n});","app.directive('player',['$compile','$templateCache','socket',function($compile,$templateCache,socket){\n\n\treturn {\n\t\trestrict: 'A',\n\t\tscope:{\n\t\t\tplayer:'='\n\t\t},\n\t\ttemplateUrl:'views/partials/player.html',\n\t\tlink:function(scope,element,attributes){\n\t\t\tsocket.on('playerUpdate',function(params){\n\t\t\t\tconsole.log(params);\n\t\t\t});\n\t\t}\n\t}\n}]);"],"sourceRoot":"/source/"}